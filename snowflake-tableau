A) Create the role (and confirm it exists)
USE ROLE ACCOUNTADMIN;

CREATE ROLE IF NOT EXISTS TABLEAU_RO;

-- ✅ should return 1 row with TABLEAU_RO
SHOW ROLES LIKE 'TABLEAU_RO';

B) Grant read privileges to that role
GRANT USAGE ON WAREHOUSE COMPUTE_WH                  TO ROLE TABLEAU_RO;
GRANT USAGE ON DATABASE RETAIL_SALES                 TO ROLE TABLEAU_RO;
GRANT USAGE ON SCHEMA   RETAIL_SALES.STAGING         TO ROLE TABLEAU_RO;

GRANT SELECT ON ALL TABLES IN SCHEMA RETAIL_SALES.STAGING TO ROLE TABLEAU_RO;
GRANT SELECT ON ALL VIEWS  IN SCHEMA RETAIL_SALES.STAGING TO ROLE TABLEAU_RO;
GRANT SELECT ON FUTURE TABLES IN SCHEMA RETAIL_SALES.STAGING TO ROLE TABLEAU_RO;
GRANT SELECT ON FUTURE VIEWS  IN SCHEMA RETAIL_SALES.STAGING TO ROLE TABLEAU_RO;

-- ✅ should list several grants to TABLEAU_RO
SHOW GRANTS TO ROLE TABLEAU_RO;

C) Create the user with a known password (and confirm)

I’m setting a concrete password so you can log in immediately. You can change it later.

CREATE OR REPLACE USER TABLEAU_USER
  PASSWORD = '****************'
  DEFAULT_ROLE = *************
  DEFAULT_WAREHOUSE = COMPUTE_WH
  DEFAULT_NAMESPACE = 'RETAIL_SALES.STAGING'
  MUST_CHANGE_PASSWORD = FALSE;

GRANT ROLE TABLEAU_RO TO USER TABLEAU_USER;

-- ✅ these should now return rows
SHOW USERS LIKE 'TABLEAU_USER';
DESCRIBE USER TABLEAU_USER;
SHOW GRANTS TO USER TABLEAU_USER;
